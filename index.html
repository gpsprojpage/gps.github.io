<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="GPS: A Probabilistic Distributional Similarity with Gumbel Priors for Set-to-Set Matching">
  <!-- <meta name="keywords" content="Nerfies, D-NeRF, NeRF"> -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>GPS: A Probabilistic Distributional Similarity with Gumbel Priors for Set-to-Set Matching</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/wpilogo.png">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
  <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({ tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']], processEscapes: true}, "HTML-CSS": {minScaleAdjust: 100} });
  </script>
</head>
<body>

<!-- <nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div> -->
  <!-- <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://keunhong.com">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>

      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          More Research
        </a>
        <div class="navbar-dropdown">
          <a class="navbar-item" href="https://hypernerf.github.io">
            HyperNeRF
          </a>
          <a class="navbar-item" href="https://nerfies.github.io">
            Nerfies
          </a>
          <a class="navbar-item" href="https://latentfusion.github.io">
            LatentFusion
          </a>
          <a class="navbar-item" href="https://photoshape.github.io">
            PhotoShape
          </a>
        </div>
      </div>
    </div>

  </div> -->
</nav>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">GPS: A Probabilistic Distributional Similarity with Gumbel Priors for Set-to-Set Matching</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://zhang-vislab.github.io/">Ziming Zhang</a><sup>1</sup><sup>*</sup>,</span>
            <span class="author-block">
              <a href="https://ark1234.github.io/">Fangzhou Lin</a><sup>1</sup><sup>†</sup>,</span>
            <span class="author-block">
              <a href="https://seanliu7081.github.io/">Haotian Liu</a><sup>1</sup><sup>‡</sup>,
            </span>
            <span class="author-block">
              <a href="https://www.linkedin.com/in/jose-morales-60b58b183/">Jose Morales</a><sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="https://yamada-lab.gr.jp/en/index.html">Kazunori Yamada</a><sup>2</sup>,
            </span>
            <span class="author-block">
              <a href="https://vkola-lab.github.io/">Vijaya B Kolachalama</a><sup>3</sup>,
            </span>
            <span class="author-block">
              <a href="https://venkatesh-saligrama.github.io/">Venkatesh Saligrama</a><sup>3</sup>
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>Worcester Polytechnic Institute, USA,</span>
            <span class="author-block"><sup>2</sup>Tohoku University, Japan</span>
            <span class="author-block"><sup>3</sup>Boston University, USA</span>
            <span class="author-block"><sup>*</sup><sup>First co-author, project leader</sup></span>
            <span class="author-block"><sup>†</sup><sup>First co-author, responsible for experiments on point cloud completion</sup></span>
            <span class="author-block"><sup>‡</sup><sup>First co-author, responsible for experiments on few-shot classification</sup></span>
            <div><b>International Conference on Learning Representations (ICLR) 2025</b></div>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://openreview.net/forum?id=U0SijGsCHJ"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <!-- <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span> -->
              <!-- Video Link. -->
              <!-- <span class="link-block">
                <a href="https://www.youtube.com/watch?v=MrKrnHhk8IA"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span> -->
              <!-- Tweet Link. -->
               <span class="link-block">
                <a href="" class="external-link button is-normal is-rounded is-dark custom-button-text">
                  <span class="icon">
                    <i class="fa-brands fa-x-twitter"></i>
                  </span>
                  <span>Tweet</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/Zhang-VISLab/ICLR2025-GPS.git"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
              <!-- Dataset Link. -->
              <!-- <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="far fa-images"></i>
                  </span>
                  <span>Data</span>
                  </a>
                </span> -->
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- <section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <video id="teaser" autoplay muted loop playsinline height="100%">
        <source src="./static/videos/teaser.mp4"
                type="video/mp4">
      </video>
      <h2 class="subtitle has-text-centered">
        <span class="dnerf">Nerfies</span> turns selfie videos from your phone into
        free-viewpoint
        portraits.
      </h2>
    </div>
  </div>
</section> -->


<!-- <section class="hero is-light is-small">
  <div class="hero-body">
    <div class="container">
      <div id="results-carousel" class="carousel results-carousel">
        <div class="item item-steve">
          <video poster="" id="steve" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/steve.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-chair-tp">
          <video poster="" id="chair-tp" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/chair-tp.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-shiba">
          <video poster="" id="shiba" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/shiba.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-fullbody">
          <video poster="" id="fullbody" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/fullbody.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-blueshirt">
          <video poster="" id="blueshirt" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/blueshirt.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-mask">
          <video poster="" id="mask" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/mask.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-coffee">
          <video poster="" id="coffee" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/coffee.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-toby">
          <video poster="" id="toby" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/toby2.mp4"
                    type="video/mp4">
          </video>
        </div> -->
    <!--/ Abstract. -->
    <section class="section">
      <div class="container is-max-desktop">
          <!-- Abstract. -->
          <div class="columns is-centered has-text-centered">
              <div class="column is-four-fifths">
                  <h2 class="title is-3">Abstract</h2>
                  <div class="content has-text-justified">
                      <p>
                        Set-to-set matching aims to identify correspondences between two sets of unordered items by minimizing a distance metric or maximizing a similarity measure.
                        Traditional metrics, such as Chamfer Distance (CD) and Earth Mover's Distance
                        (EMD), are widely used for this purpose but often suffer from limitations like
                        suboptimal performance in terms of accuracy and robustness, or high computational costs - or both. In this paper, we propose an effective set-to-set matching
                        similarity measure, GPS, based on Gumbel prior distributions. These distributions
                        are typically used to model the extrema of samples drawn from various distributions. Our approach is motivated by the observation that the distributions of
                        minimum distances from CD, as encountered in real-world applications such as
                        point cloud completion, can be accurately modeled using Gumbel distributions. We
                        validate our method on tasks like few-shot image classification and 3D point cloud
                        completion, demonstrating significant improvements over state-of-the-art loss functions across several benchmark datasets.</p>
                        <div class="columns is-centered">
                          <div class="column is-half">
                            <figure>
                              <img src="./static/images/set_matching_example.png" alt="" style="width: 100%">
                              <figcaption>Figure 1: Illustration of three point sets randomly sampled from a circular distribution (i.e., Distr. 1) and a Gaussian whose mean is conditional on the circle (i.e., Distr. 2)</figcaption>
                            </figure>
                          </div>
                          <div class="column is-half">
                            <figure>
                              <img src="./static/images/model_fit.png " alt="" style="width: 100%">
                              <figcaption>Figure 2: Data fitting with Gumbel distributions for 1st, 2nd, 3rd smallest distance distributions between two 2D point sets</figcaption>
                            </figure>
                          </div>
                        </div>
                  </div>
              </div>
          </div>
      </div>
    </section>
    <!--/ Abstract. -->

    <section class="section">
      <div class="container is-max-desktop">
          <!-- Introduction. -->
          <div class="columns is-centered has-text-centered">
              <div class="column is-four-fifths">
                  <h2 class="title is-3">Introduction</h2>
                  <div class="content has-text-justified">
                      <p>
                        $\textbf{Problem Statement}$ Set-to-set matching involves comparing and identifying correspondences between two sets of items, which can be modeled as a bipartite graph matching problem. In this framework, the items
                        in each set are represented as nodes on opposite sides of a bipartite graph, with the edges representing the correspondences. This task is challenging due to several factors: 
                        (1) The matching process must be invariant to the order of both the sets and the items within them; (2) Finding effective representations for each set is critical, as it greatly influences 
                        performance; (3) Computing a meaningful similarity score between sets, often used as a loss function for learning feature extractors, is a nontrivial problem. 
                        Our goal is to develop a similarity measure that is both effective and efficient for set-to-set matching.</p>
                      <p align="center">
                        <img src="" alt="" style="width: 70%"></img>
                      </p>
                      <p>
                        $\textbf{Limitations of Traditional Distance Metrics}$ Existing metrics fail to adequately capture the similarity between sets in terms of their underlying distributions. In many real-world 
                        applications, such as classification, the primary concern is not the direct similarity between individual data instances but rather their similarity in some (latent) space, such as class labels.
                        For instance, in Figure 1 in the context of Chamfer Distance (CD), the distance between the sets $\circ$ and $+$ is larger than that between the sets $\circ$ and $+$, despite 
                        $\circ$ and $\times$ being sampled from the same underlying distribution. This highlights a issue: $\textit{how likely are two sets of points to come from the same distribution?}$ 
                        CD and similar metrics may fail to reflect distributional similarity accurately. Consequently, traditional distance metrics are effective at measuring differences in observations (\eg point clouds or images) 
                        but may struggle to capture deeper, potentially unknown $\textit{abstractions}$ such as distributions or class labels.
                      </p>
                      <p>
                        $\textbf{Our Approach and Contributions}$ We propose a novel probabilistic method for set-to-set matching called GPS (Gumbel Prior Similarity) based on distributional similarity and Gumbel 
                        distributions. This method measures the similarity between the underlying distributions generating the sets. Specifically, we use the log-likelihood of Gumbel distributions as our similarity 
                        measure, modeling the distributions of negative-log distances between the KNNs of the sets. GPS can be seamlessly integrated into existing neural network training frameworks, for instance, by 
                        using the negative of GPS as a loss function, while maintaining the same linear computational complexity as CD. We propose a comprehensive analysis of GPS and its influence on learning behavior.
                        We are the first to leverage statistical information from KNNs for set-to-set matching. To demonstrate the efficacy and efficiency of GPS, we conduct extensive experiments on tasks such as 
                        few-shot image classification and 3D point cloud completion, achieving state-of-the-art performance across several benchmark datasets.
                      </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="section">
      <div class="container is-max-desktop">
          <!-- Approach. -->
          <div class="columns is-centered has-text-centered">
              <div class="column is-four-fifths">
                  <h2 class="title is-3">Approach</h2>
                  <div class="content has-text-justified">
                      <p>
                        $\textbf{Notations & Problem Definition}$ We denote $\mathcal{X}_1=\{x_{1,i}\}\sim\mathcal{P}_1, \mathcal{X}_2=\{x_{2,j}\}\sim\mathcal{P}_2$ as two sets of points (or items) that are sampled from two unknown 
                        distributions $\mathcal{P}_1, \mathcal{P}_2$, respectively, and $K$ as the number of nearest neighbors considered for each point. Also, we refer to $|\cdot|$ as the cardinality of a set, and $\|\cdot\|$ as the 
                        $\ell_2$-norm of a vector. Given these notations, our goal is to predict the set-to-set similarity, $\kappa(\mathcal{X}_1, \mathcal{X}_2)$, based on the conditional probability 
                        $p(\mathcal{P}_1=\mathcal{P}_2 | \mathcal{X}_1, \mathcal{X}_2)$.</p>
                      <p align="center">
                        <img src="" alt="" style="width: 70%"></img>
                      </p>
                      <p>
                        $\textbf{Gumbel Distributions}$ Recall that the Gumbel distribution is used to model the distribution of the $\textit{maximum}$ (or minimum by replacing the maximum with the negative of minimum) of a number of samples 
                        from various distributions. Here we list the definition of a Gumbel distribution as follows: The probability density function (PDF) of a Gumbel distribution with parameters $\mu\in\mathbb{R}, \sigma>0$, 
                        denoted as $Gumbel(\mu, \sigma)$, for a random variable $x\in\mathbb{R}$ is defined as 
                        $p$
                        \begin{equation} 
                        p(x) = \frac{1}{\sigma}\exp\{-(y + \exp\{-y\})\}, \; \text{where} \; y = \frac{x - \mu}{\sigma}. 
                        \end{equation}</p>
                      <p>$\textbf{Distributional Signatures}$ Given two sets of points $\mathcal{X}_1, \mathcal{X}_2$, we define the set of Euclidean distances from each point in one set to its KNNs in the other set as their distributional signature:
                        \begin{equation}
                            \mathcal{D}(\mathcal{X}_1, \mathcal{X}_2) = \left\{d_{min}^{(k)}(x_{1,i}) = \|x_{1,i} - x_{2,i_k}\|, d_{min}^{(k)}(x_{2,j}) = \|x_{2,j} - x_{1,j_k}\| \mid \forall k\in[K], \forall i, \forall j \right\}
                        \end{equation}
                        where $i_k$ ($\textit{resp}$ $j_k$) denotes the index of the $k$-th nearest neighbor in $\mathcal{X}_2$ ($\textit{resp}$ $\mathcal{X}_1$) for $x_{1,i}$ (\resp $x_{2,j}$), leading to an unordered set of $K(|\mathcal{X}_1| + |\mathcal{X}_2|)$ values.</p>
                      <p>
                        $\textbf{Probabilistic Modeling}$ To compute GPS, we introduce the Gumbel distributions and distributional signatures as latent variables, as shown in, and propose a probabilistic framework as follows:
                        \begin{equation}
                        p(\mathcal{P}_1=\mathcal{P}_2 \mid \mathcal{X}_1, \mathcal{X}_2) = \sum_{q\in\mathcal{Q}}\sum_{d_{min}\in\mathcal{D}}  p(\mathcal{P}_1=\mathcal{P}_2, q, d_{min} \mid \mathcal{X}_1, \mathcal{X}_2) \nonumber \\ 
                        = \sum_{q\in\mathcal{Q}}\sum_{d_{min}\in\mathcal{D}} p(q)p(\mathcal{P}_1=\mathcal{P}_2 \mid q) p(d_{min} \mid q, \mathcal{X}_1, \mathcal{X}_2),
                        \end{equatioin}
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>





<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@inproceedings{zhanggps,
      title={GPS: A Probabilistic Distributional Similarity with Gumbel Priors for Set-to-Set Matching},
      author={Zhang, Ziming and Lin, Fangzhou and Liu, Haotian and Morales, Jose and Zhang, Haichong and Yamada, Kazunori and Kolachalama, Vijaya B and Saligrama, Venkatesh},
      booktitle={The Thirteenth International Conference on Learning Representations}
    }</code></pre>
  </div>
</section>


<footer class="footer">
  <!-- <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link"
         href="./static/videos/nerfies_paper.pdf">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://github.com/keunhong" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div> -->
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            Website design borrowed from <a href="https://github.com/nerfies/nerfies.github.io">NeRFies</a>
          </p>
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
